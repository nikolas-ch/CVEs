Open Redirect - CVE-2025-29033 (Reported and validated on a HackerOne Private Program)
------------------------------
Affected Product: BambooHR (http://bamboohr.com/)

Version: Build version 25.0210.170831-83b08dd


Description:
An open redirect occurs when a web application accepts untrusted input that specifies a URL to redirect a user to. If the application does not properly validate or sanitize this input, it can be manipulated by attackers to redirect users to arbitrary, potentially malicious sites. This flaw is commonly exploited in phishing attacks, where users are deceived into visiting fraudulent websites that appear legitimate.
This security issue affects the "/saml/index.php?r=" HTTP GET parameter. This request is executed when the "Log in with Okta" button (SSO Okta mechanism integrated) is clicked. 

An attacker can send a crafted link (e.g. https://targeted-company.bamboohr.com/saml/index.php?r=https://malicious-domain.com) to the targeted users via phishing and trick them into clicking on it and redirecting them on an attacker's controlled domain (successful redirection requires the targeted user to already be authenticated to the Okta service).

Since this vulnerability exists in the SSO flow, an attacker can trick the authentication server into sending the authorization code to the malicious domain. Then, the attacker can exchange this code for an access token, thus impersonating the targeted user.


Impacts:
Breaking Login Flows (SSO) - Open redirect can let attackers hijack the SSO flow and steal authorization codes.
Phishing Attacks - Attackers can craft URLs that appear to be from trusted sources but redirect users to malicious sites designed to steal sensitive information.
Malware Distribution - Redirects can lead users to sites that automatically download and install malware, compromising user devices and data.
Credential Theft - Users may be tricked into entering login credentials on fraudulent sites, leading to unauthorized access to their accounts.
Cross-Site Scripting (XSS) - In some cases, open redirects can be exploited to execute malicious scripts in a user's browser, potentially leading to unauthorized actions or data theft.
Reputation Damage - Exploitation of this vulnerability can damage the trust users place in your product, potentially affecting your company's reputation and user base.


Recommendations:
Input Validation - Implement strict validation of all user inputs, especially those that specify URLs for redirection, to ensure they point to trusted destinations.
Use Relative URLs - Where possible, use relative URLs for redirection to prevent manipulation of the destination URL.
Whitelist Redirects -  Maintain a whitelist of allowed redirect URLs and ensure that any redirection points to a URL within this list.
Use PKCE (Proof Key for Code Exchange) - This makes the authorization code useless without the correct code verifier.
User Education - Inform users about the risks of phishing and encourage them to verify URLs before clicking on links.



